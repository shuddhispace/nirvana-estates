<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rentals - Nirvana Estates</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .ratio-4-3 { aspect-ratio: 4 / 3; }
    .ratio-16-9 { aspect-ratio: 16 / 9; }
    .ratio-9-16 { aspect-ratio: 9 / 16; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .card { transition: transform .2s, box-shadow .2s; }
    .card:hover { transform: translateY(-3px); box-shadow: 0 10px 24px rgba(0,0,0,.12); }
    .nav-btn { position:absolute; top:50%; transform: translateY(-50%); background: rgba(0,0,0,.35); color:#fff; padding:.35rem .55rem; border-radius:.5rem;}
    .nav-btn:hover{ background: rgba(0,0,0,.6);}
    .nav-left{ left:.25rem;} .nav-right{ right:.25rem;}
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  
<div id="header-placeholder"></div>
<script>
  fetch('header.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('header-placeholder').innerHTML = data;

    const toggleBtn = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');

    if (toggleBtn && mobileMenu) {
      toggleBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });

      const menuLinks = mobileMenu.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      });
    }
  })
  .catch(err => console.error('Failed to load header:', err));

</script>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-5">Properties for Rentals</h2>

    <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Cards -->
    </div>
  </main>

  <a href="tel:+918652121984"
     class="fixed bottom-4 right-4 z-50 bg-[#0f2b3d] text-white px-4 py-3 rounded-full shadow-lg font-semibold">
    ðŸ“ž Call Now
  </a>

<script>
const INR = n => {
  const num = Number(n);
  if (isNaN(num)) return `â‚¹${n}`;
  return num.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 });
};

function createMediaSlide(src, type) {
  const wrap = document.createElement('div');
  wrap.className = 'relative w-full flex-shrink-0 snap-center';
  if (type === 'image') {
    const img = new Image();
    img.src = src;
    img.alt = 'Property image';
    img.className = 'w-full h-full object-cover';
    wrap.classList.add('ratio-4-3');
    img.onload = () => {
      const ratio = img.naturalWidth / img.naturalHeight;
      if (ratio >= 1.6) { wrap.classList.remove('ratio-4-3'); wrap.classList.add('ratio-16-9'); }
    };
    wrap.appendChild(img);
  } else {
    const vid = document.createElement('video');
    vid.src = src;
    vid.preload = 'metadata';
    vid.muted = true;
    vid.playsInline = true;
    vid.controls = true;
    vid.className = 'w-full h-full object-cover';
    wrap.classList.add('ratio-16-9');
    vid.addEventListener('loadedmetadata', () => {
      if (vid.videoHeight > vid.videoWidth) { wrap.classList.remove('ratio-16-9'); wrap.classList.add('ratio-9-16'); }
    });
    vid.addEventListener('mouseenter', () => vid.play());
    vid.addEventListener('mouseleave', () => vid.pause());
    wrap.appendChild(vid);
  }
  return wrap;
}

function propertyCard(p) {
  const card = document.createElement('article');
  card.className = 'card bg-white rounded-xl overflow-hidden shadow';

  const mediaTrack = document.createElement('div');
  mediaTrack.className = 'relative w-full bg-gray-200 overflow-x-auto flex gap-2 no-scrollbar snap-x snap-mandatory';
  const mediaInner = document.createElement('div');
  mediaInner.className = 'flex w-full gap-2';

  const allMedia = [
    ...(Array.isArray(p.images) ? p.images.map(s => ({src:s, type:'image'})) : []),
    ...(Array.isArray(p.videos) ? p.videos.map(s => ({src:s, type:'video'})) : [])
  ];

  if (allMedia.length === 0) {
    const placeholder = document.createElement('div');
    placeholder.className = 'ratio-4-3 w-full flex items-center justify-center text-gray-500';
    placeholder.textContent = 'No media';
    mediaTrack.appendChild(placeholder);
  } else {
    allMedia.forEach(m => mediaInner.appendChild(createMediaSlide(m.src, m.type)));
    mediaTrack.appendChild(mediaInner);

    const left = document.createElement('button');
    left.className = 'nav-btn nav-left hidden sm:block';
    left.innerHTML = '&#10094;';
    left.addEventListener('click', () => mediaTrack.scrollBy({ left: -mediaTrack.clientWidth * 0.8, behavior: 'smooth' }));
    const right = document.createElement('button');
    right.className = 'nav-btn nav-right hidden sm:block';
    right.innerHTML = '&#10095;';
    right.addEventListener('click', () => mediaTrack.scrollBy({ left: mediaTrack.clientWidth * 0.8, behavior: 'smooth' }));
    card.appendChild(mediaTrack); card.appendChild(left); card.appendChild(right);
  }

  const body = document.createElement('div');
  body.className = 'p-4 flex flex-col gap-2';
  const headerRow = document.createElement('div');
  headerRow.className = 'flex items-start justify-between gap-3';
  const title = document.createElement('h3');
  title.className = 'text-lg font-semibold text-gray-900';
  title.textContent = p.title || 'Property';
  const price = document.createElement('span');
  price.className = 'text-[#0f2b3d] font-bold';
  price.textContent = INR(p.price);
  headerRow.append(title, price);

  const sub = document.createElement('p');
  sub.className = 'text-gray-600 text-sm';
  sub.textContent = `${p.bedrooms} Bed | ${p.bathrooms} Bath | Carpet: ${p.carpetArea} sq ft | Built-up: ${p.builtupArea} sq ft | ${p.location}`;

  const badgeRow = document.createElement('div');
  if (p.negotiable) {
    const badge = document.createElement('span');
    badge.className = 'inline-block bg-green-600 text-white text-xs px-2 py-1 rounded';
    badge.textContent = 'Negotiable';
    badgeRow.appendChild(badge);
  }

  const ctas = document.createElement('div');
  ctas.className = 'mt-2 flex flex-wrap gap-2';
  const details = document.createElement('a');
  details.href = `property-details.html?id=${p.id}`;
  details.target = '_blank';
  details.className = 'px-3 py-2 rounded bg-[#0f2b3d] text-white text-sm font-semibold hover:bg-[#15425c]';
  details.textContent = 'View Details';
  const call = document.createElement('a');
  call.href = 'tel:+918652121984';
  call.className = 'px-3 py-2 rounded bg-green-600 text-white text-sm font-semibold hover:bg-green-700';
  call.textContent = 'Call';
  ctas.append(details, call);

  body.append(headerRow, sub, badgeRow, ctas);
  card.appendChild(body);
  return card;
}

async function load() {
  try {
    const res = await fetch('/data/properties.json');
    const list = await res.json();
    const grid = document.getElementById('grid');
    grid.innerHTML = '';
    list.filter(p => (p.category || '').toLowerCase() === 'rentals')
        .forEach(p => grid.appendChild(propertyCard(p)));
  } catch (e) {
    console.error(e);
    document.getElementById('grid').innerHTML =
      '<div class="text-red-600">Failed to load properties.</div>';
  }
}

load();
</script>
</body>
</html>
